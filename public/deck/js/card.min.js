var userVue=new Vue({el:"#app",data:{id:1,name:"\u533f\u540d",balance:0,photo:"css/user.png",lostTemplate:["\u4f60\u7684\u4eba\u54c1\u8c8c\u4f3c\u4e0d\u4f73\u54df\uff0c\u8f93\u4e86 {}","\u8bf6\uff0c\u9a9a\u5e74\uff0c\u4f60\u9700\u8981\u7ee7\u7eed\u52aa\u529b\uff0c\u4e22\u4e86 {}","\u5931\u53bb{}\uff0c\u5bf9\u7740\u5929\u7a7a\u5927\u58f0\u543c\uff0c\u8be5\u51fa\u624b\u65f6\u5c31\u51fa\u624b\u5440\u3002"]}}),easing=Deck.easing,prefix=Deck.prefix,transform=prefix("transform"),transition=prefix("transition"),
    transitionDelay=prefix("transitionDelay"),boxShadow=prefix("boxShadow"),translate=Deck.translate,$container=document.getElementById("container"),$toolbar=document.getElementById("toolbar"),$poker=document.createElement("button");$poker.textContent="\u5f00\u59cb\u6e38\u620f";$toolbar.appendChild($poker);var deck=Deck(),acesClicked=[],kingsClicked=[];
deck.cards.forEach(function(a,b){function c(){var a;if(0===b%13)acesClicked[b]=!0,4===acesClicked.filter(function(a){return a}).length&&(document.body.removeChild($toolbar),deck.$el.style.display="none",setTimeout(function(){startWinning()},250));else if(12===b%13){if(kingsClicked&&(kingsClicked[b]=!0,4===kingsClicked.filter(function(a){return a}).length)){for(var c=0;3>c;c++)a=Deck.Card(52+c),a.mount(deck.$el),a.$el.style[transform]="scale(0)",a.enableMoving(),deck.cards.push(a);deck.sort(!0);kingsClicked=
    !1}}else acesClicked=[],kingsClicked&&(kingsClicked=[])}a.$el.addEventListener("mousedown",c);a.$el.addEventListener("touchstart",c);a.$el.card=a});var betMoney=0,totalBetMoney=0,betNumber=0,leftNumber=0,turnCarding=!1,currentMoney=0,prevBetMoney=0,isFourCard=!1,gameRunning=!1;
function onTurnCard(a){if(!(turnCarding||0>=leftNumber)){turnCarding=!0;var b=this,c=a.target;b.removeEventListener("mousedown",onTurnCard);b.removeEventListener("touchend",onTurnCard);c.classList.remove("back");turnCard(c.parentNode,function(){c.parentNode.classList.add(b.card.suitName,b.card.suitNameValue);b.card.$el.getElementsByClassName("topleft")[0].innerHTML=b.card.value;b.card.$el.getElementsByClassName("bottomright")[0].innerHTML=b.card.value},function(){turnCarding=!1;--leftNumber;console.log(b.card.value);
    switch(b.card.value){case 1:currentMoney+=2*betMoney;break;case 2:currentMoney+=1.5*betMoney;break;case 3:currentMoney+=betMoney;break;case 4:isFourCard=!0,console.log("\u4e0b\u4e00\u5c40\u4eab\u53d7\u4e0b\u6ce8\u4e00\u5f20\u51cf\u534a")}if(0<leftNumber){var a=printMessage("\u60a8\u8fd8\u6709"+leftNumber+"\u5f20\u724c\u53ef\u4ee5\u7ffb\u54df~",200,"tip");document.body.removeChild(a)}else 0==leftNumber&&(userVue.balance+=currentMoney,0<currentMoney-totalBetMoney?isFourCard?$("#contentDiv").text("\u606d\u559c\u4f60\u8d62\u4e86 "+
        (currentMoney-totalBetMoney)+"\uff0c\u8fd8\u4e2d\u4e86\u56db\u7b49\u5956\uff0c\u4e0b\u6b21\u540c\u7b49\u4e0b\u6ce8\u91d1\u989d\u53ef\u51cf\u534a\u4f46\u4eab\u53d7\u540c\u7b49\u91d1\u989d\u7684\u5956\u52b1\u54e6\uff0c\u59a5\u59a5\u54d2~"):$("#contentDiv").text("\u606d\u559c\u4f60\u8d62\u4e86 "+(currentMoney-totalBetMoney)+"\uff0c\u59a5\u59a5\u54d2~"):0==currentMoney-totalBetMoney?isFourCard?$("#contentDiv").text("\u5443\uff0c\u4f60\u53ea\u4e2d\u4e86\u56db\u7b49\u5956\uff0c\u4e0b\u6b21\u540c\u7b49\u91d1\u989d\u9996\u6ce8\u51cf\u534a\u4f46\u4eab\u53d7\u540c\u7b49\u91d1\u989d\u7684\u5956\u52b1\u54e6~"):
        $("#contentDiv").text("\u5443\uff0c\u8fd9\u6b21\u6ca1\u6709\u8fdb\u8d26\u4e5f\u6ca1\u6709\u635f\u5931\u54df~"):isFourCard?$("#contentDiv").text("\u5443\uff0c\u4f60\u635f\u5931\u4e86"+(currentMoney-totalBetMoney)+"\uff0c\u4f46\u4e2d\u4e86\u56db\u7b49\u5956\uff0c\u4e0b\u6b21\u540c\u7b49\u91d1\u989d\u9996\u6ce8\u51cf\u534a\u4f46\u4eab\u53d7\u540c\u7b49\u91d1\u989d\u7684\u5956\u52b1\u54e6~"):(a=getRandomNum(userVue.lostTemplate.length-1),$("#contentDiv").text(userVue.lostTemplate[a].replace("{}",currentMoney-
        totalBetMoney))),prevBetMoney=betMoney,document.getElementById("modal2").classList.add("md-show"),$poker.removeAttribute("disabled"),gameRunning=!1,updateUseMoney(userVue.id,userVue.balance))})}}
function turnCard(a,b,c){var d=a.getAttribute("rotateY");d||(d="0");a.setAttribute("rotateY","0"==d?"-180":"0");a.getAttribute("transform")||a.setAttribute("transform",a.style.transform);a.style.transition="";montion(a,"200ms",function(){this.style.transform=this.getAttribute("transform")+" scale(0)"},function(){b();montion(this,"500ms",function(){this.style.transform=this.getAttribute("transform")+" scale(1)"},c)})}
function montion(a,b,c,d){a.style.transition=b;c.call(a);var e=!1;a.addEventListener("transitionend",function(){e||(d&&d.call(a),e=!0)},!1)}
$poker.addEventListener("click",function(){deck.cards.forEach(function(a,b){a.$el.removeAttribute("transform");a.$el.classList.remove(a.suitName,a.suitNameValue);a.$el.classList.add("back");a.$el.getElementsByClassName("topleft")[0].innerHTML="";a.$el.getElementsByClassName("bottomright")[0].innerHTML="";$poker.setAttribute("disabled","disabled")});deck.shuffle();deck.shuffle();deck.shuffle();deck.poker();setTimeout(function(){document.getElementById("modal").classList.add("md-show");isFourCard&&
$("#selectMoneyDiv .btn").each(function(){$(this).text()==prevBetMoney?$(this).addClass("select"):$(this).removeClass("select")})},3200);[].slice.call(document.querySelectorAll(".message")).forEach(function(a,b){a.style[transform]=translate(-window.innerWidth+"px",0)})});deck.mount($container);$poker.setAttribute("disabled","disabled");deck.intro();deck.fan();setTimeout(function(){$poker.removeAttribute("disabled")},2E3);
function startTip(){var a=1E4+6E4*Math.random();setTimeout(function(){gameRunning||printMessage("\u7ffb\u4e2dA\u8fd4\u56de2\u500d\u91d1\u989d\u54df...")},a);setTimeout(function(){gameRunning||printMessage("\u6e38\u620f\u597d\u73a9\uff0c\u53ef\u4e0d\u8981\u8fc7\u4e8e\u6c89\u6eba\u54df...")},a+5E3);setTimeout(function(){gameRunning||printMessage("...\u795d\u5404\u4f4d\u597d\u8fd0 ;)")},a+1E4)}
function printMessage(a,b,c){c||(c="message");var d=document.createElement("p");d.classList.add(c);d.textContent=a;document.body.appendChild(d);d.style[transform]=translate(window.innerWidth+"px",0);b||(b=1E3);setTimeout(function(){d.style[transition]="all .7s "+easing("cubicInOut");d.style[transform]=translate(0,0)},b);setTimeout(function(){d.style[transform]=translate(-window.innerWidth+"px",0)},4E3);setTimeout(function(){document.body.removeChild(d)},5E3);return d}
function startGame(){if(betMoney=getSelectMoney())if(betNumber=getSelectCardNumber())document.getElementById("modal").classList.remove("md-show"),currentMoney=0,leftNumber=betNumber,totalBetMoney=betMoney*betNumber,isFourCard&&betMoney!=prevBetMoney||(isFourCard&&(totalBetMoney=betMoney/2+betMoney*(betNumber-1)),0>userVue.balance-totalBetMoney?($("#contentDiv").text("\u4f60\u7684\u4f59\u989d\u5df2\u7ecf\u4e0d\u8db3"+totalBetMoney+"\uff0c\u8bf7\u5148\u5145\u503c\u5427~"),document.getElementById("modal2").classList.add("md-show"),
    $poker.removeAttribute("disabled")):(printMessage("\u8bf7\u5f00\u59cb\u7ffb\u724c\u5427\uff0c\u795d\u541b\u597d\u8fd0\uff01",200,"tip"),userVue.balance-=totalBetMoney,gameRunning=!0,isFourCard=!1,deck.cards.forEach(function(a,b){a.$el.addEventListener("mousedown",onTurnCard);a.$el.addEventListener("touchend",onTurnCard)}),$poker.setAttribute("disabled","disabled"),$("#selectCardDiv .btn.select").removeClass("select"),$("#selectMoneyDiv .btn.select").removeClass("select"),[].slice.call(document.querySelectorAll(".message")).forEach(function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      b){a.style[transform]=translate(-window.innerWidth+"px",0)})))}var selectFx;
$(function(){$("#selectMoneyDiv .btn").click(function(){$(this).siblings(".select").removeClass("select");$(this).addClass("select");selectFx.selPlaceholder.textContent="10 - 100 \u81ea\u9009";selectFx.current=-1;parseInt($(this).text())!=prevBetMoney&&isFourCard?$("#selectTitle").text("\u4e0d\u4eab\u53d7\u56db\u7b49\u5956\u4f18\u60e0"):isFourCard?$("#selectTitle").text("\u9996\u6ce8\u91d1\u989d\u51cf\u534a"):$("#selectTitle").text("\u6295\u6ce8")});$("#selectCardDiv .btn").click(function(){$(this).siblings(".select").removeClass("select");
    $(this).addClass("select");"\u9996\u6ce8\u91d1\u989d\u51cf\u534a"!=$("#selectTitle").text()&&$("#selectTitle").text("\u6295\u6ce8")});document.getElementById("md-overlay").addEventListener("click",function(){document.getElementById("modal").classList.remove("md-show");$poker.removeAttribute("disabled")});selectFx=new SelectFx(document.getElementById("otherSelect"),{stickyPlaceholder:!1,onChange:function(a){$("#selectMoneyDiv .btn.select").removeClass("select");parseInt(a)!=prevBetMoney&&isFourCard?
    $("#selectTitle").text("\u4e0d\u4eab\u53d7\u56db\u7b49\u5956\u4f18\u60e0"):isFourCard?$("#selectTitle").text("\u9996\u6ce8\u91d1\u989d\u51cf\u534a"):$("#selectTitle").text("\u6295\u6ce8");return!1}});$("#preLoad").remove();startTip();initData()});function getSelectMoney(){var a=$("#selectMoneyDiv .btn.select").text();a||-1==selectFx.current||(a=selectFx.el.value);if(a&&""!=a)return parseInt(a);$("#selectTitle").text("\u8bf7\u9009\u62e9\u91d1\u989d")}
function getSelectCardNumber(){var a=$("#selectCardDiv .btn.select").text();if(a&&""!=a)return parseInt(a);$("#selectTitle").text("\u8bf7\u9009\u62e9\u7ffb\u5361\u5f20\u6570")}
function restart(){document.getElementById("modal2").classList.remove("md-show");deck.cards.forEach(function(a,b){a.$el.removeAttribute("transform");a.$el.classList.add(a.suitName,a.suitNameValue);a.$el.classList.remove("back");a.$el.getElementsByClassName("topleft")[0].innerHTML=a.value;a.$el.getElementsByClassName("bottomright")[0].innerHTML=a.value});deck.fan()}function getRandomNum(a){a||(a=100);return Math.ceil(Math.random()*a)};